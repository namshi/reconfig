(function(global,factory){if(typeof define==="function"&&define.amd){define("Reconfig",["module","exports","lodash.foreach","lodash.includes","lodash.set","lodash.get","lodash.escaperegexp","lodash.isobject","lodash.isundefined","lodash.isnull","lodash.clonedeep","lodash.merge","lodash.isarray"],factory)}else if(typeof exports!=="undefined"){factory(module,exports,require("lodash.foreach"),require("lodash.includes"),require("lodash.set"),require("lodash.get"),require("lodash.escaperegexp"),require("lodash.isobject"),require("lodash.isundefined"),require("lodash.isnull"),require("lodash.clonedeep"),require("lodash.merge"),require("lodash.isarray"))}else{var mod={exports:{}};factory(mod,mod.exports,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash,global.lodash);global.Reconfig=mod.exports}})(this,function(module,exports,_lodash,_lodash3,_lodash5,_lodash7,_lodash9,_lodash11,_lodash13,_lodash15,_lodash17,_lodash19,_lodash21){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _lodash2=_interopRequireDefault(_lodash);var _lodash4=_interopRequireDefault(_lodash3);var _lodash6=_interopRequireDefault(_lodash5);var _lodash8=_interopRequireDefault(_lodash7);var _lodash10=_interopRequireDefault(_lodash9);var _lodash12=_interopRequireDefault(_lodash11);var _lodash14=_interopRequireDefault(_lodash13);var _lodash16=_interopRequireDefault(_lodash15);var _lodash18=_interopRequireDefault(_lodash17);var _lodash20=_interopRequireDefault(_lodash19);var _lodash22=_interopRequireDefault(_lodash21);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol?"symbol":typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var getConfigFromEnv=function getConfigFromEnv(prefix){var separator=arguments.length<=1||arguments[1]===undefined?"_":arguments[1];var envConfig={};(0,_lodash2.default)(process.env,function(value,key){if((0,_lodash4.default)(key,prefix)){var path=key.replace(prefix+separator,"").replace(new RegExp(separator,"g"),".");(0,_lodash6.default)(envConfig,path,value)}});return envConfig};var Reconfig=function(){function Reconfig(config){var _ref=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var envPrefix=_ref.envPrefix;var separator=_ref.separator;var _ref$paramsInterpolat=_ref.paramsInterpolation;var paramsInterpolation=_ref$paramsInterpolat===undefined?[":",""]:_ref$paramsInterpolat;_classCallCheck(this,Reconfig);this._config=null;this._rawConfig=null;this._envPrefix=envPrefix;this._separator=separator;this._paramsInterpolation=paramsInterpolation.map(_lodash10.default);this.set(config)}_createClass(Reconfig,[{key:"resolveReferences",value:function resolveReferences(){var _this=this;var value=arguments.length<=0||arguments[0]===undefined?"":arguments[0];var reference=null;var references=value.match(/{{\s*[\w\.]+\s*}}/g);if(references&&references.length===1){reference=this.resolve(this.get(references[0].replace(/[^\w.]/g,"")));if((typeof reference==="undefined"?"undefined":_typeof(reference))==="object"){return reference}}return value.replace(/{{\s*[\w\.]+\s*}}/g,function(ref){return _this.resolve(_this.get(ref.replace(/[^\w.]/g,"")))})}},{key:"resolveParameters",value:function resolveParameters(value,parameters){if(!(0,_lodash12.default)(parameters)){return value}for(var property in parameters){if(value){value=value.replace(RegExp(this._paramsInterpolation[0]+property+this._paramsInterpolation[1],"g"),parameters[property]||"")}}return value}},{key:"resolveObject",value:function resolveObject(object,parameters){var _this2=this;var clonedObject=(0,_lodash18.default)(object);(0,_lodash2.default)(clonedObject,function(value,key){clonedObject[key]=_this2.resolve(value,parameters)});return clonedObject}},{key:"resolve",value:function resolve(value,parameters){if(typeof value==="string"){value=this.resolveReferences(value);if(parameters){value=this.resolveParameters(value,parameters)}}if((typeof value==="undefined"?"undefined":_typeof(value))==="object"){value=this.resolveObject(value,parameters)}return value}},{key:"set",value:function set(config){if(!config){return}if(this._envPrefix){if(process&&process.env&&typeof process.env!=="string"){(0,_lodash20.default)(config,getConfigFromEnv(this._envPrefix,this._separator))}else{console.warn("HEY HEY HEY, this feature is supposed to be used in node only :)")}}this._config=this._rawConfig=(0,_lodash12.default)(this._rawConfig)||(0,_lodash22.default)(this._rawConfig)?(0,_lodash20.default)(this._rawConfig,config):config;this._config=this.resolve(this._config)}},{key:"get",value:function get(path,parameters,fallbackValue){if(!path){return this._config}var value=(0,_lodash8.default)(this._config,path,fallbackValue);value=parameters?this.resolve(value,parameters):value;return(0,_lodash14.default)(value)||(0,_lodash16.default)(value)?null:value}}]);return Reconfig}();exports.default=Reconfig;module.exports=exports["default"]});
//# sourceMappingURL=build/reconfig.min.js.map